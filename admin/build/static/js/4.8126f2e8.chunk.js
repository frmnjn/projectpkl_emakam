webpackJsonp([4],{559:function(e,a,t){"use strict";function n(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function s(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function o(e,a){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?e:a}function l(e,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}Object.defineProperty(a,"__esModule",{value:!0});var r=t(0),i=t.n(r),c=(t(179),t(9)),m=t(181),u=(t.n(m),t(182)),d=(t.n(u),t(103)),h=t(33),g=(t.n(h),t(177)),k=(t.n(g),function(){function e(e,a){for(var t=0;t<a.length;t++){var n=a[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(a,t,n){return t&&e(a.prototype,t),n&&e(a,n),a}}()),p=function(e){function a(e){s(this,a);var t=o(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.acc_dinas=function(e){e.preventDefault();var a="http://localhost:8000/api/dokumen/cetak_dokumen_permohonan?token="+sessionStorage.getItem("token")+"&tanggal_sekarang="+t.get_tanggal_sekarang()+"&nama_ahli_waris="+t.state.activenosurat.nama_pewaris+"&alamat_ahli_waris="+t.state.activenosurat.alamat_ahli_waris+"&tanggal_wafat="+t.state.activenosurat.tanggal_wafat+"&nama_almarhum="+t.state.activenosurat.nama_almarhum+"&ttl_almarhum="+t.state.activenosurat.tanggal_lahir_alm+"&ttl_ahli_waris="+t.state.activenosurat.tgllhr_ahli_waris+"&jenis_kelamin_almarhum="+t.state.activenosurat.jenis_kelamin+"&tpu_almarhum="+t.state.activenosurat.nama_tpu+"&alamat_almarhum="+t.state.activenosurat.alamat_terakhir+"&tanggal_pemakaman="+t.state.activenosurat.tanggal_pemakaman+"&blok_almarhum="+t.state.activenosurat.kode_blok+"&no_surat_permohonan="+t.state.no_surat;window.location=a,t.update_status_acc_dinas(t.state.activenosurat.id,"Menunggu Persetujuan Kepala Kecamatan"),t.modalnosuratclose()},t.handleChange=function(e){t.setState(n({},e.target.name,e.target.value))},t.surat_permohonan=function(e){if(console.log(e),null!=e.no_surat_permohonan){var a="http://localhost:8000/api/dokumen/cetak_dokumen_permohonan?token="+sessionStorage.getItem("token")+"&tanggal_sekarang="+e.tanggal_surat_permohonan+"&nama_ahli_waris="+e.nama_pewaris+"&alamat_ahli_waris="+e.alamat_ahli_waris+"&tanggal_wafat="+e.tanggal_wafat+"&nama_almarhum="+e.nama_almarhum+"&ttl_almarhum="+e.tanggal_lahir_alm+"&ttl_ahli_waris="+e.tgllhr_ahli_waris+"&jenis_kelamin_almarhum="+e.jenis_kelamin+"&tpu_almarhum="+e.nama_tpu+"&alamat_almarhum="+e.alamat_terakhir+"&tanggal_pemakaman="+e.tanggal_pemakaman+"&blok_almarhum="+e.kode_blok+"&no_surat_permohonan="+e.no_surat_permohonan;window.location=a}else alert("nomor surat belum ada")},t.toggle=t.toggle.bind(t),t.toggleclose=t.toggleclose.bind(t),t.modalkkclose=t.modalkkclose.bind(t),t.modalktpclose=t.modalktpclose.bind(t),t.modalsuratclose=t.modalsuratclose.bind(t),t.modalnosuratclose=t.modalnosuratclose.bind(t),t.modalskclose=t.modalskclose.bind(t),t.modalsklamaclose=t.modalsklamaclose.bind(t),t.toggleproggress=t.toggleproggress.bind(t),t.fetchdata=t.fetchdata.bind(t),t.update_status=t.update_status.bind(t),t.acc_kec=t.acc_kec.bind(t),t.acc_dinas=t.acc_dinas.bind(t),t.acc_kupt=t.acc_kupt.bind(t),t.cek_kelengkapan=t.cek_kelengkapan.bind(t),t.state={dropdownOpen:!1,radioSelected:2,error:null,isLoaded:!1,isSend:!1,isFiltered:!0,filter_keyword:"",items:[],showitems:[],itemsperblok:[],blok:[],details_almarhum:[],blokfilter:!1,itemblokfilter:[],activename:null,activeqty:null,activesupplier:null,formqty:"1",activedata:[],activektp:null,activekk:null,activenosurat:[],no_surat:null},t.fetchdata(),t}return l(a,e),k(a,[{key:"get_tanggal_sekarang",value:function(){var e=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],a=new Date,t=a.getDate(),n=a.getMonth(),s=a.getYear();return t+" "+e[n]+" "+(s<1e3?s+1900:s)}},{key:"update_status",value:function(e,a){fetch("http://localhost:8000/api/dokumen/update?token="+sessionStorage.getItem("token"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e,status:a})}).then(function(e){return e.json()}).then(function(e){alert("Permintaan telah berhasil diproses")}).then(this.fetchdata)}},{key:"update_status_acc_dinas",value:function(e,a){var t=this;fetch("http://localhost:8000/api/dokumen/update?token="+sessionStorage.getItem("token"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e,status:a,no_surat_permohonan:this.state.no_surat,tanggal_surat_permohonan:this.get_tanggal_sekarang()})}).then(function(e){return e.json()}).then(function(e){alert("Permohonan izin berhasil diproses")}).then(this.fetchdata).catch(function(e){t.setState({isLoaded:!1}),alert("Permintaan tidak dapat diproses")})}},{key:"acc_kec",value:function(e){var a=this;alert("sistem sedang memproses data dan mencoba mengirim email. tunggu sebentar...");fetch("http://localhost:8000/api/send?to="+e.email+"&message=Permohonan izin penggunaan lahan makam anda telah diproses silahkan ke ambil pada kecamatan").then(this.setState({isSend:!0})).then(console.log("sending")).catch(function(e){a.setState({isLoaded:!1}),alert("Permintaan tidak dapat diproses")}),this.update_status(e.id,"Proses Selesai")}},{key:"acc_kupt",value:function(e){this.update_status(e,"Menunggu Persetujuan Kepala Dinas")}},{key:"cek_kelengkapan",value:function(e){var a=this;fetch("http://localhost:8000/api/dokumen/update?token="+sessionStorage.getItem("token"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e,kelengkapan_dokumen:"Lengkap"})}).then(function(e){return e.json()}).then(function(e){alert("Update Sukses")}).catch(function(e){a.setState({isLoaded:!1}),alert("Permintaan tidak dapat diproses")})}},{key:"componentDidMount",value:function(){}},{key:"fetchdata",value:function(){var e=this;fetch("http://localhost:8000/api/dokumen/view?token="+sessionStorage.getItem("token")+"&id_user="+sessionStorage.getItem("id_user")+"&role="+sessionStorage.getItem("login_session")).then(function(e){return e.json()}).then(function(a){if("2"==sessionStorage.getItem("login_session")){var t;t=a,t=t.filter(function(e){return-1!==e.kelengkapan_dokumen.toLowerCase().search("lengkap")&&-1!==e.status.toLowerCase().search("menunggu persetujuan kepala upt")}),e.setState({showitems:t})}else if("3"==sessionStorage.getItem("login_session")){var t;t=a,t=t.filter(function(e){return-1!==e.kelengkapan_dokumen.toLowerCase().search("lengkap")&&-1!==e.status.toLowerCase().search("menunggu persetujuan kepala dinas")}),e.setState({showitems:t})}else if("4"==sessionStorage.getItem("login_session")){var t;t=a,t=t.filter(function(e){return-1!==e.kelengkapan_dokumen.toLowerCase().search("lengkap")&&-1!==e.status.toLowerCase().search("menunggu persetujuan kepala kecamatan")}),e.setState({showitems:t})}else e.setState({showitems:a});e.setState({isLoaded:!0,items:a})})}},{key:"checksuratpermohonan",value:function(e){return null!=e.no_surat_permohonan?e.no_surat_permohonan:"-"}},{key:"checksuratizin",value:function(e){return null!=e.no_surat_perizinan?e.no_surat_perizinan:"-"}},{key:"checksklama",value:function(e){var a=this;return"-"!=e.file_sk_lama?i.a.createElement(c.d,{id:"buttonsk",color:"info",onClick:function(){return a.modalsklama(e)},className:"mr-1"},i.a.createElement("i",{className:"icon-note icons text-left"})):i.a.createElement(c.d,{id:"buttonsk",color:"info",disabled:!0,onClick:function(){return a.modalsklama(e)},className:"mr-1"},i.a.createElement("i",{className:"icon-note icons text-left"}))}},{key:"proggress",value:function(e){return"Menunggu Persetujuan Kepala UPT"==e?1:"Menunggu Persetujuan Kepala Dinas"==e?2:"Menunggu Persetujuan Kepala Kecamatan"==e?3:"Proses Selesai"==e?4:0}},{key:"toggle",value:function(e){this.setState({activedata:e,modal:!this.state.modal})}},{key:"modalkk",value:function(e){this.setState({activekk:e.file_kk.substring(6),kkmodal:!this.state.kkmodal})}},{key:"modalsk",value:function(e){this.setState({activesk:e.file_sk.substring(6),skmodal:!this.state.skmodal})}},{key:"modalsklama",value:function(e){this.setState({activesklama:e.file_sk_lama.substring(6),sklamamodal:!this.state.sklamamodal})}},{key:"nosuratmodal",value:function(e){this.setState({activenosurat:e,nosuratmodal:!this.state.nosuratmodal})}},{key:"modalktp",value:function(e){this.setState({activektp:e.file_ktp.substring(6),ktpmodal:!this.state.ktpmodal})}},{key:"modalsurat",value:function(e){this.setState({activesurat:e.file_surat_izin.substring(6),suratmodal:!this.state.suratmodal})}},{key:"modalkkclose",value:function(){this.setState({kkmodal:!this.state.kkmodal})}},{key:"modalnosuratclose",value:function(){this.setState({nosuratmodal:!this.state.nosuratmodal})}},{key:"modalktpclose",value:function(){this.setState({ktpmodal:!this.state.ktpmodal})}},{key:"modalsuratclose",value:function(){this.setState({suratmodal:!this.state.suratmodal})}},{key:"modalskclose",value:function(){this.setState({skmodal:!this.state.skmodal})}},{key:"modalsklamaclose",value:function(){this.setState({sklamamodal:!this.state.sklamamodal})}},{key:"toggleclose",value:function(){this.setState({modal:!this.state.modal})}},{key:"toggleproggress",value:function(){this.setState({modalprogress:!this.state.modalprogress})}},{key:"render",value:function(){var e=this;return console.log(this.state.showitems),this.state.isLoaded?i.a.createElement("div",{className:"animated fadeIn"},i.a.createElement(c.v,{isOpen:this.state.modal,toggle:this.toggleclose,className:"modal-Large "+this.props.className},i.a.createElement(c.y,{toggle:this.toggleclose},"Lihat Data Penghuni Makam"),i.a.createElement(c.w,null,i.a.createElement("form",{className:"form-group",onSubmit:""},i.a.createElement("label",null,"Nama Penghuni Makam"),i.a.createElement("input",{type:"text",className:"form-control",name:"activenama",value:this.state.activedata.nama,disabled:!0}),i.a.createElement("label",null,"Alamat Terakhir")))),i.a.createElement(c.v,{isOpen:this.state.nosuratmodal,toggle:this.modalnosuratclose,className:"modal-Large "+this.props.className},i.a.createElement(c.y,{toggle:this.modalnosuratclose},"No Surat"),i.a.createElement(c.w,null,i.a.createElement("form",{className:"form-group",onSubmit:this.acc_dinas},i.a.createElement("div",{class:"form-group"},i.a.createElement("label",null,"No Surat"),i.a.createElement("input",{type:"text",className:"form-control",onChange:this.handleChange,name:"no_surat"})),i.a.createElement("input",{type:"submit",className:"form-control btn btn-primary",Value:"Submit"})))),i.a.createElement(c.v,{isOpen:this.state.ktpmodal,toggle:this.modalktpclose,className:"modal-Large "+this.props.className},i.a.createElement(c.y,{toggle:this.modalktpclose},"Kartu Tanda Penduduk"),i.a.createElement(c.w,null,i.a.createElement("img",{src:"http://localhost:8000/storage"+this.state.activektp,class:"img-fluid",alt:"Responsive image"}))),i.a.createElement(c.v,{isOpen:this.state.kkmodal,toggle:this.modalkkclose,className:"modal-Large "+this.props.className},i.a.createElement(c.y,{toggle:this.modalkkclose},"Kartu Keluarga"),i.a.createElement(c.w,null,i.a.createElement("img",{src:"http://localhost:8000/storage"+this.state.activekk,class:"img-fluid",alt:"Responsive image"}))),i.a.createElement(c.v,{isOpen:this.state.suratmodal,toggle:this.modalsuratclose,className:"modal-Large "+this.props.className},i.a.createElement(c.y,{toggle:this.modalsuratclose},"Surat Permohonan"),i.a.createElement(c.w,null,i.a.createElement("img",{src:"http://localhost:8000/storage"+this.state.activesurat,class:"img-fluid",alt:"Responsive image"}))),i.a.createElement(c.v,{isOpen:this.state.skmodal,toggle:this.modalskclose,className:"modal-Large "+this.props.className},i.a.createElement(c.y,{toggle:this.modalskclose},"Surat Kematian"),i.a.createElement(c.w,null,i.a.createElement("img",{src:"http://localhost:8000/storage"+this.state.activesk,class:"img-fluid",alt:"Responsive image"}))),i.a.createElement(c.v,{isOpen:this.state.sklamamodal,toggle:this.modalsklamaclose,className:"modal-Large "+this.props.className},i.a.createElement(c.y,{toggle:this.modalsklamaclose},"Surat Izin Lama"),i.a.createElement(c.w,null,i.a.createElement("img",{src:"http://localhost:8000/storage"+this.state.activesklama,class:"img-fluid",alt:"Responsive image"}))),i.a.createElement(c.D,null,i.a.createElement(c.h,null,i.a.createElement(c.e,null,i.a.createElement(c.g,null,"Manajemen Dokumen"),i.a.createElement(c.f,null,i.a.createElement(d.a,{data:this.state.showitems,resolveData:function(e){return e.map(function(e){return e})},defaultPageSize:10,filterable:!0,columns:[{accessor:"id",show:!1},{accessor:"nama_almarhum",show:!1},{accessor:"nik_ahli_waris",show:!1},{accessor:"alamat_ahli_waris",show:!1},{accessor:"tanggal_wafat",show:!1},{accessor:"id_penghuni_makam",show:!1},{accessor:"tanggal_lahir_alm",show:!1},{accessor:"tanggal_pemakaman",show:!1},{accessor:"tgllhr_ahli_waris",show:!1},{accessor:"jenis_kelamin",show:!1},{accessor:"nama_tpu",show:!1},{accessor:"alamat_terakhir",show:!1},{accessor:"kode_blok",show:!1},{accessor:"id_kecamatan",show:!1},{accessor:"no_surat_perizinan",show:!1},{accessor:"tanggal_surat_permohonan",show:!1},{accessor:"tanggal_surat_perizinin",show:!1},{accessor:"no_surat_permohonan",show:!1},{Header:"Kode Registrasi",accessor:"kode_registrasi"},{Header:"Nama Almarhum",accessor:"nama_almarhum"},{Header:"Nama Pewaris",accessor:"nama_pewaris"},{Header:"Email Pewaris",show:!1,accessor:"email"},{Header:"Nomor Surat Izin",accessor:"no_surat_perizinan",Cell:function(a){return i.a.createElement("div",null,e.checksuratizin(a.row))}},{Header:"Nomor Surat Permohonan",accessor:"no_surat_permohonan",Cell:function(a){return i.a.createElement("div",null,e.checksuratpermohonan(a.row))}},{filterable:!1,Header:"KTP Almarhum",show:!1,accessor:"file_ktp",Cell:function(e){return i.a.createElement("div",null)}},{Header:"KK Almarhum",filterable:!1,show:!1,accessor:"file_kk",Cell:function(e){return i.a.createElement("div",null)}},{Header:"Kelengkapan Dokumen",filterable:!1,width:200,accessor:"file_sk",Cell:function(a){return i.a.createElement("div",null,i.a.createElement(c.d,{color:"info",onClick:function(){return e.modalktp(a.row)},className:"mr-1"},i.a.createElement("i",{className:"icon-credit-card text-left"})),i.a.createElement(c.d,{color:"info",onClick:function(){return e.modalkk(a.row)},className:"mr-1"},i.a.createElement("i",{className:"icon-map icons text-left"})),i.a.createElement(c.d,{color:"info",onClick:function(){return e.modalsk(a.row)},className:"mr-1"},i.a.createElement("i",{className:"icon-layers icons text-left"})),e.checksklama(a.row))}},{Header:"SK Lama Almarhum",filterable:!1,show:!1,accessor:"file_sk_lama",Cell:function(e){return i.a.createElement("div",null)}},{Header:"Surat Permohonan",show:!1,filterable:!1,accessor:"file_surat_izin",Cell:function(a){return i.a.createElement("div",null,i.a.createElement(c.d,{color:"info",onClick:function(){return e.modalsurat(a.row)},className:"mr-1"},i.a.createElement("i",{className:"icon-magnifier icons text-left"})))}},{Header:"Kelengkapan Dokumen",accessor:"kelengkapan_dokumen",show:!1},{Header:"Status",accessor:"status"},{Header:"Unduh Surat Permohonan",show:"4"==sessionStorage.getItem("login_session"),Cell:function(a){return i.a.createElement("div",null,i.a.createElement(c.d,{color:"info",onClick:function(){return e.surat_permohonan(a.row)},className:"mr-1"},"Unduh"))}},{Header:"Actions",filterable:!1,accessor:"status",show:"4"==sessionStorage.getItem("login_session"),Cell:function(a){return i.a.createElement("div",null,i.a.createElement(c.d,{color:"info",onClick:function(){return e.acc_kec(a.row)},className:"mr-1"},"Accept"))}},{Header:"Actions",filterable:!1,accessor:"status",show:"3"==sessionStorage.getItem("login_session"),Cell:function(a){return i.a.createElement("div",null,i.a.createElement(c.d,{color:"info",onClick:function(){return e.nosuratmodal(a.row)},className:"mr-1"},"Keluarkan Surat Permohonan"))}},{Header:"Actions",filterable:!1,show:!1,accessor:"status",Cell:function(a){return i.a.createElement("div",null,i.a.createElement(c.d,{color:"info",onClick:function(){return e.cek_kelengkapan(a.row.id)},className:"mr-1"},"Accept"))}},{Header:"Actions",accessor:"status",show:"2"==sessionStorage.getItem("login_session"),Cell:function(a){return i.a.createElement("div",null,i.a.createElement(c.d,{color:"info",onClick:function(){return e.acc_kupt(a.row.id)},className:"mr-1"},"Rekomendasi"))}}]}),i.a.createElement("hr",null)))))):i.a.createElement("div",{style:{display:"flex",justifyContent:"center",margin:100}},i.a.createElement("div",{className:"sweet-loading"},i.a.createElement(h.RingLoader,{color:"#123abc"})))}}]),a}(r.Component);a.default=p}});
//# sourceMappingURL=4.8126f2e8.chunk.js.map