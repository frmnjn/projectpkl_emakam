webpackJsonp([5],{555:function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(0),s=a.n(i),r=a(39),c=(a(179),a(180)),m=(a.n(c),a(178),a(9)),u=a(72),h=a(33),d=(a.n(h),a(104)),g=(a.n(d),a(73)),k=a.n(g),f=a(177),p=(a.n(f),function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}()),E=function(e){function t(e){n(this,t);var a=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.handleKode=function(e){a.setState({kodeaktif:e.target.value})},a.handleNomor=function(e){a.setState({nomoraktif:e.target.value})},a.handleBlok=function(e){var t=e.target.value.split(",");a.setState({blokaktif:t[0],kodeaktif:t[1]})},a.toggle=a.toggle.bind(a),a.ToggleDelete=a.ToggleDelete.bind(a),a.ToggleDeleteclose=a.ToggleDeleteclose.bind(a),a.toggleEdit=a.toggleEdit.bind(a),a.toggleEditclose=a.toggleEditclose.bind(a),a.toggleCreate=a.toggleCreate.bind(a),a.toggleLocation=a.toggleLocation.bind(a),a.toggleLocationClose=a.toggleLocationClose.bind(a),a.toggleHistory=a.toggleHistory.bind(a),a.toggleHistoryClose=a.toggleHistoryClose.bind(a),a.handleEdit=a.handleEdit.bind(a),a.fetchmakam=a.fetchmakam.bind(a),a.handleDelete=a.handleDelete.bind(a),a.handleCreate=a.handleCreate.bind(a),a.mapClicked=a.mapClicked.bind(a),a.onRadioBtnClick=a.onRadioBtnClick.bind(a),a.fetchpenghuni=a.fetchpenghuni.bind(a),a.status_penghuni=a.status_penghuni.bind(a),a.status_terisi=a.status_terisi.bind(a),a.state={dropdownOpen:!1,radioSelected:2,error:null,isLoaded:!1,items:[],blok:[],penghuni:[],lng:null,lat:null,idmakamaktif:null,nomoraktif:null,blokaktif:null,kodeaktif:null,formqty:"1"},a}return o(t,e),p(t,[{key:"componentDidMount",value:function(){var e=this;this.fetchmakam(),this.fetchpenghuni(),fetch("http://149.28.138.217/api/blok/view?token="+sessionStorage.getItem("token")+"&id_user="+sessionStorage.getItem("id_user")).then(function(e){return e.json()}).then(function(t){e.setState({isLoaded:!0,blok:t})})}},{key:"fetchmakam",value:function(){var e=this;fetch("http://149.28.138.217/api/makam/view?token="+sessionStorage.getItem("token")+"&id_user="+sessionStorage.getItem("id_user")).then(function(e){return e.json()}).then(function(t){e.setState({isLoaded:!0,items:t})})}},{key:"fetchpenghuni",value:function(){var e=this;fetch("http://149.28.138.217/api/penghuni_makam/view?token="+sessionStorage.getItem("token")+"&id_user="+sessionStorage.getItem("id_user")).then(function(e){return e.json()}).then(function(t){e.setState({penghuni:t})})}},{key:"handleEdit",value:function(e){var t=this;fetch("http://149.28.138.217/api/makam/edit/"+this.state.idmakamaktif+"?token="+sessionStorage.getItem("token"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id_blok:this.state.blokaktif,nomor_makam:this.state.nomoraktif,kode_makam:this.state.kodeaktif+"-"+this.state.nomoraktif,lat:this.state.lat,lng:this.state.lng})}).then(function(e){return e.json()}).then(function(e){Array.isArray(e)?alert(e):alert("pembuatan makam gagal")}).then(this.setState({edit:!this.state.edit})).then(this.fetchmakam).catch(function(e){t.setState({isLoaded:!1}),alert("Permintaan tidak dapat diproses")})}},{key:"handleCreate",value:function(){var e=this;fetch("http://149.28.138.217/api/makam/create?token="+sessionStorage.getItem("token"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id_blok:this.state.blokaktif,nomor_makam:this.state.nomoraktif,kode_makam:this.state.kodeaktif+"-"+this.state.nomoraktif,lat:this.state.lat,lng:this.state.lng})}).then(function(e){return e.json()}).then(function(e){Array.isArray(e)?alert(e):alert("pembuatan makam gagal")}).then(this.setState({create:!this.state.create})).then(this.fetchmakam).catch(function(t){e.setState({isLoaded:!1}),alert("Permintaan tidak dapat diproses")})}},{key:"handleDelete",value:function(){fetch("http://149.28.138.217/api/makam/delete/"+this.state.idmakamaktif+"?token="+sessionStorage.getItem("token"),{method:"DELETE"}).then(function(e){return e.json()}).then(function(e){Array.isArray(e)?alert(e):alert("pembuatan makam gagal")}).then(this.setState({small:!this.state.small})).then(this.fetchmakam)}},{key:"mapClicked",value:function(e,t,a){this.setState({lat:a.latLng.lat(),lng:a.latLng.lng()})}},{key:"handleDeleteEx",value:function(){fetch("http://149.28.138.217/api/makam/delete_ex?token="+sessionStorage.getItem("token"),{method:"DELETE"}).then(function(e){return e.json()}).then(function(e){console.log(e)}).then(alert("delete sukses"),this.fetchmakam)}},{key:"mapClicked",value:function(e,t,a){this.setState({lat:a.latLng.lat(),lng:a.latLng.lng()})}},{key:"status_penghuni",value:function(e){var t=this.state.penghuni;t=t.filter(function(t){return-1!==t.id_makam.toString().search(e.toString())});var a="-";return t.map(function(e){a=e.status}),a}},{key:"status_terisi",value:function(e){var t=this.state.penghuni,a=k()();t=t.filter(function(t){return-1!==t.id_makam.toString().search(e.id_makam.toString())});var n="yellow",l=a.diff(k()(e.created_at)),o=Math.floor(k.a.duration(l).asYears());return t.map(function(e){n="Terisi"}),"Terisi"==n?o<2?s.a.createElement("p",{style:{color:"red"}},"Terisi"):o<3?s.a.createElement("p",{style:{color:"grey"}},"Terisi"):s.a.createElement("p",{style:{color:"green"}},"Terisi"):s.a.createElement("p",{style:{color:"yellow"}},"Kosong")}},{key:"filter_history",value:function(e){var t=this.state.penghuni.filter(function(t){return t.id_makam==e});return console.log(t),t}},{key:"toggle",value:function(){this.setState({dropdownOpen:!this.state.dropdownOpen})}},{key:"onRadioBtnClick",value:function(e){this.setState({radioSelected:e})}},{key:"toggle",value:function(){this.setState({modal:!this.state.modal})}},{key:"ToggleDelete",value:function(e){this.setState({small:!this.state.small,idmakamaktif:e.id_makam,nomoraktif:e.kode_makam})}},{key:"ToggleDeleteclose",value:function(){this.setState({small:!this.state.small})}},{key:"toggleEdit",value:function(e){this.setState({edit:!this.state.edit,idmakamaktif:e.id_makam,nomoraktif:e.nomor_makam,kodeaktif:e.kode_blok,blokaktif:e.id_blok,lng:e.lng,lat:e.lat})}},{key:"toggleEditclose",value:function(){this.setState({edit:!this.state.edit})}},{key:"toggleCreate",value:function(){this.setState({lng:"112.613468",lat:"-7.952229",create:!this.state.create})}},{key:"toggleLocation",value:function(e){console.log(e),this.setState({location:!this.state.location,lng:e.lng,lat:e.lat})}},{key:"toggleLocationClose",value:function(){this.setState({location:!this.state.location})}},{key:"toggleHistory",value:function(e){console.log(e),this.setState({history:!this.state.history,kodeaktif:e.id_makam})}},{key:"toggleHistoryClose",value:function(){this.setState({history:!this.state.history})}},{key:"render",value:function(){var e=this;return this.state.isLoaded?1==sessionStorage.getItem("login_session")?s.a.createElement("div",{className:"animated fadeIn"},s.a.createElement(m.D,null,s.a.createElement(m.h,null,s.a.createElement(m.v,{isOpen:this.state.create,toggle:this.toggleCreate,className:"modal-sm "+this.props.className},s.a.createElement(m.y,{toggle:this.toggleCreate},"Buat Baru"),s.a.createElement(m.w,null,s.a.createElement(m.D,null,s.a.createElement(m.h,{xs:"12"},s.a.createElement("div",{className:"small text-muted"},s.a.createElement("span",null,"Masukan Data")))),s.a.createElement("br",null),s.a.createElement(m.D,null,s.a.createElement(m.h,{xs:"12"},s.a.createElement(m.o,{onChange:this.handleBlok,type:"select",name:"",id:"blok"},s.a.createElement("option",null,"Pilih Blok"),this.state.blok.map(function(e){return s.a.createElement("option",{value:e.id_blok+","+e.kode_blok},e.kode_blok)})),s.a.createElement("br",null),s.a.createElement(m.o,{onChange:this.handleNomor,type:"text",id:"input1-group3",name:"input1-group3",placeholder:"Nomor Makam"}),s.a.createElement("br",null))),s.a.createElement(m.D,null,s.a.createElement(m.h,{style:{height:"50vh",width:"5vw"}},s.a.createElement(d.Map,{onClick:this.mapClicked,google:this.props.google,initialCenter:{lat:this.state.lat,lng:this.state.lng},zoom:18,style:{width:"90%"}},s.a.createElement(d.Marker,{position:{lat:this.state.lat,lng:this.state.lng},onClick:this.onMarkerClick,name:"Current location"}),s.a.createElement(d.InfoWindow,{onClose:this.onInfoWindowClose},s.a.createElement("div",null,s.a.createElement("h1",null,"Lalala"))))))),s.a.createElement(m.x,null,s.a.createElement(m.d,{color:"primary",onClick:this.handleCreate},"Buat")," ",s.a.createElement(m.d,{color:"secondary",onClick:this.toggleCreate},"Batal"))),s.a.createElement(m.v,{isOpen:this.state.edit,toggle:this.toggleEditclose,className:"modal-sm "+this.props.className},s.a.createElement(m.y,{toggle:this.toggleEditclose},"edit"),s.a.createElement(m.w,null,s.a.createElement(m.D,null,s.a.createElement(m.h,{xs:"12"},s.a.createElement("div",{className:"small text-muted"},s.a.createElement("span",null,"Blok / Nomor")))),s.a.createElement("br",null),s.a.createElement(m.D,null,s.a.createElement(m.h,{xs:"12"},s.a.createElement(m.p,null,s.a.createElement(m.q,{addonType:"prepend"},s.a.createElement(m.o,{onChange:this.handleBlok,type:"select",name:"blok",id:"blok"},this.state.blok.map(function(t){return s.a.createElement("option",{value:t.id_blok+","+t.kode_blok,selected:t.id_blok==e.state.blokaktif},t.kode_blok)}))),s.a.createElement(m.o,{onChange:this.handleNomor,type:"text",id:"input1-group3",name:"input1-group3",value:this.state.nomoraktif})))),s.a.createElement("hr",null),s.a.createElement(m.D,null,s.a.createElement(m.h,{style:{height:"50vh",width:"5vw"}},s.a.createElement(d.Map,{onClick:this.mapClicked,google:this.props.google,initialCenter:{lat:this.state.lat,lng:this.state.lng},zoom:18,style:{width:"90%"}},s.a.createElement(d.Marker,{position:{lat:this.state.lat,lng:this.state.lng},onClick:this.onMarkerClick,name:"Current location"}),s.a.createElement(d.InfoWindow,{onClose:this.onInfoWindowClose},s.a.createElement("div",null,s.a.createElement("h1",null,"Lalala"))))))),s.a.createElement(m.x,null,s.a.createElement(m.d,{color:"success",onClick:function(){return e.handleEdit()}},"edit")," ",s.a.createElement(m.d,{color:"secondary",onClick:this.toggleEditclose},"Cancel"))),s.a.createElement(m.v,{isOpen:this.state.small,toggle:this.ToggleDeleteclose,className:"modal-sm "+this.props.className},s.a.createElement(m.y,{toggle:this.ToggleDeleteclose}),s.a.createElement(m.w,null,s.a.createElement("strong",null,"Menghapus makam akan menghapus seluruh data penghuni makam"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("strong",null,"Apakah anda yakin ingin menghapus makam ",this.state.nomoraktif," ?")),s.a.createElement(m.x,null,s.a.createElement(m.d,{color:"danger",onClick:function(){return e.handleDelete()}},"hapus"),s.a.createElement(m.d,{color:"secondary",onClick:this.ToggleDeleteclose},"batal"))),s.a.createElement(m.v,{isOpen:this.state.location,toggle:this.toggleLocationClose,className:"modal-large "+this.props.className},s.a.createElement(m.y,{toggle:this.toggleLocation},"Lokasi Makam"),s.a.createElement(m.w,null,s.a.createElement("div",null,s.a.createElement(m.D,null,s.a.createElement(m.h,{style:{height:"50vh"}},s.a.createElement(d.Map,{google:this.props.google,initialCenter:{lat:this.state.lat,lng:this.state.lng},zoom:18,style:{width:"95%"}},s.a.createElement(d.Marker,{position:{lat:this.state.lat,lng:this.state.lng},onClick:this.onMarkerClick,name:"Current location"}),s.a.createElement(d.InfoWindow,{onClose:this.onInfoWindowClose},s.a.createElement("div",null,s.a.createElement("h1",null,"Lalala")))))))),s.a.createElement(m.x,null,s.a.createElement(m.d,{color:"secondary",onClick:this.toggleLocationClose},"Close"))),s.a.createElement(m.v,{isOpen:this.state.history,toggle:this.toggleHistoryClose,className:"modal-large "+this.props.className},s.a.createElement(m.y,{toggle:this.state.toggleHistory},"Riwayat Penghuni Makam"),s.a.createElement(m.w,null,s.a.createElement(u.a,{data:this.filter_history(this.state.kodeaktif),defaultPageSize:10,defaultSorted:[{id:"tanggal_pemakaman",desc:!0}],columns:[{accessor:"id_makam",show:!1},{Header:"Kode Makam",accessor:"kode_makam",Cell:function(e){return s.a.createElement("div",null,e.row.kode_makam)}},{Header:"Nama Penghuni Makam",accessor:"nama",Cell:function(e){return s.a.createElement("div",null,e.row.nama)}},{Header:"Tanggal Wafat",accessor:"tanggal_wafat",Cell:function(e){return s.a.createElement("div",null,e.row.tanggal_wafat)}},{Header:"Tanggal Pemakaman",accessor:"tanggal_pemakaman",Cell:function(e){return s.a.createElement("div",null,e.row.tanggal_pemakaman)}}]})),s.a.createElement(m.x,null,s.a.createElement(m.d,{color:"secondary",onClick:this.toggleHistoryClose},"Close"))),s.a.createElement(m.e,null,s.a.createElement(m.g,null,s.a.createElement(m.D,null,s.a.createElement(m.h,{col:"10"},s.a.createElement("strong",null,"Manajemen Makam")),s.a.createElement(m.h,{col:"2",className:"text-right"},s.a.createElement(m.d,{onClick:this.toggleCreate,outline:!0,color:"primary"},"Create"),s.a.createElement(m.d,{onClick:this.handleDeleteEx,outline:!0,color:"primary"},"Delete Old Data")))),s.a.createElement(m.f,null,s.a.createElement(u.a,{data:this.state.items,defaultPageSize:10,filterable:!0,columns:[{accessor:"id_makam",show:!1},{accessor:"kode_blok",show:!1},{accessor:"lat",show:!1},{accessor:"lng",show:!1},{accessor:"nomor_makam",show:!1},{accessor:"created_at",show:!1},{Header:"Nomor Makam",show:!1,Cell:function(e){return s.a.createElement("div",null,e.row.nomor_makam)}},{Header:"Kode Makam",accessor:"kode_makam",Cell:function(e){return s.a.createElement("div",null,e.row.kode_makam)}},{Header:"Kode Blok",accessor:"kode_blok",Cell:function(e){return s.a.createElement("div",null,e.row.kode_blok)}},{Header:"TPU",accessor:"nama_tpu",Cell:function(e){return s.a.createElement("div",null,e.row.nama_tpu)}},{Header:"Status Makam",Cell:function(t){return s.a.createElement("div",null,e.status_terisi(t.row))}},{Header:"Actions",accessor:"id_blok",filterable:!1,Cell:function(t){return s.a.createElement("div",null,s.a.createElement(m.D,null,"\u2003",s.a.createElement(m.d,{onClick:function(){return e.toggleLocation(t.row)},outline:!0,color:"primary"},s.a.createElement("i",{className:"cui-location-pin icons text-left"})," "),"\u2003",s.a.createElement(m.d,{onClick:function(){return e.toggleEdit(t.row)},outline:!0,color:"success"},s.a.createElement("i",{className:"cui-pencil icons text-left"})," "),"\u2003",s.a.createElement(m.d,{onClick:function(){return e.ToggleDelete(t.row)},outline:!0,color:"danger"},s.a.createElement("i",{className:"cui-circle-x icons text-left"})," "),"\u2003",s.a.createElement(m.d,{onClick:function(){return e.toggleHistory(t.row)},outline:!0,color:"info"},s.a.createElement("i",{className:"icon-magnifier icons text-left"})," "),s.a.createElement(m.h,{col:"1",xl:!0,className:""}),s.a.createElement(m.h,{col:"1",xl:!0,className:""}),s.a.createElement(m.h,{col:"1",xl:!0,className:""}),s.a.createElement(m.h,{col:"1",xl:!0,className:""})))}}]}),s.a.createElement("hr",null)))))):"0"==sessionStorage.getItem("login_session")?s.a.createElement("div",null,alert("Anda tidak memiliki hak akses!"),s.a.createElement(r.d,{to:"/login"})):s.a.createElement(r.d,{to:"/404"}):s.a.createElement("div",{style:{display:"flex",justifyContent:"center",margin:100}},s.a.createElement("div",{className:"sweet-loading"},s.a.createElement(h.RingLoader,{color:"#123abc"})))}}]),t}(i.Component);E.defaultProps={center:{lat:-7.952229,lng:112.613468},zoom:20},t.default=Object(d.GoogleApiWrapper)({apiKey:"AIzaSyDTUAyUGbuCXiRX6ywsz4ZIAf_jDPPRwUM"})(E)}});
//# sourceMappingURL=5.1728f7a2.chunk.js.map